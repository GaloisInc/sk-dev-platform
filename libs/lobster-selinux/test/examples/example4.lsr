// Prelude

class PrimProcess() {
  port active : {position = subject};
  port process__dyntransition ;
  port process__execheap ;
  port process__execmem ;
  port process__execstack ;
  port process__fork ;
  port process__getattr ;
  port process__getcap ;
  port process__getpgid ;
  port process__getsched ;
  port process__getsession ;
  port process__noatsecure ;
  port process__ptrace ;
  port process__rlimitinh ;
  port process__setcap ;
  port process__setcurrent ;
  port process__setexec ;
  port process__setfscreate ;
  port process__setkeycreate ;
  port process__setpgid ;
  port process__setrlimit ;
  port process__setsched ;
  port process__setsockcreate ;
  port process__share ;
  port process__sigchld ;
  port process__siginh ;
  port process__sigkill ;
  port process__signal ;
  port process__signull ;
  port process__sigstop ;
  port process__transition ;
  port fd__use;
}

// for type_transition rules
// hack: currently also adds a role declaration for the new type
class TypeTransition(t,n) {
  port process;
}

class Process(filename) {
  port active;
  port create;
  port child;
  domain f = File(filename);
  domain p = PrimProcess();
//  domain t = TypeTransition(f,p);
// fragile hack in sync with Domain.hs
  domain t = TypeTransition("f_t","p_t");
  active -- p.active;
  create -- f.getattr;
  create -- f.read;
  create -- f.execute;
  create -- p.process__transition;
  create -- t.process;
}

class File(filenameRegex) {
  port append ;
  port create ;
  port entrypoint ;
  port execmod ;
  port execute ;
  port execute_no_trans ;
  port getattr ;
  port ioctl ;
  port link ;
  port lock ;
  port mounton ;
  port open ;
  port quotaon ;
  port read ;
  port relabelfrom ;
  port relabelto ;
  port rename ;
  port setattr ;
  port swapon ;
  port unlink ;
  port write ;
}

class Type (selinuxType) {
  port active : { position = subject };
  port appletalk_socket__accept ;
  port appletalk_socket__append ;
  port appletalk_socket__bind ;
  port appletalk_socket__connect ;
  port appletalk_socket__create ;
  port appletalk_socket__getattr ;
  port appletalk_socket__getopt ;
  port appletalk_socket__ioctl ;
  port appletalk_socket__listen ;
  port appletalk_socket__lock ;
  port appletalk_socket__name_bind ;
  port appletalk_socket__read ;
  port appletalk_socket__recv_msg ;
  port appletalk_socket__recvfrom ;
  port appletalk_socket__relabelfrom ;
  port appletalk_socket__relabelto ;
  port appletalk_socket__send_msg ;
  port appletalk_socket__sendto ;
  port appletalk_socket__setattr ;
  port appletalk_socket__setopt ;
  port appletalk_socket__shutdown ;
  port appletalk_socket__write ;
  port association__polmatch ;
  port association__recvfrom ;
  port association__sendto ;
  port association__setcontext ;
  port blk_file__append ;
  port blk_file__create ;
  port blk_file__execute ;
  port blk_file__getattr ;
  port blk_file__ioctl ;
  port blk_file__link ;
  port blk_file__lock ;
  port blk_file__mounton ;
  port blk_file__open ;
  port blk_file__quotaon ;
  port blk_file__read ;
  port blk_file__relabelfrom ;
  port blk_file__relabelto ;
  port blk_file__rename ;
  port blk_file__setattr ;
  port blk_file__swapon ;
  port blk_file__unlink ;
  port blk_file__write ;
  port capability__audit_control ;
  port capability__audit_write ;
  port capability__chown ;
  port capability__dac_override ;
  port capability__dac_read_search ;
  port capability__fowner ;
  port capability__fsetid ;
  port capability__ipc_lock ;
  port capability__ipc_owner ;
  port capability__kill ;
  port capability__lease ;
  port capability__linux_immutable ;
  port capability__mknod ;
  port capability__net_admin ;
  port capability__net_bind_service ;
  port capability__net_broadcast ;
  port capability__net_raw ;
  port capability__setfcap ;
  port capability__setgid ;
  port capability__setpcap ;
  port capability__setuid ;
  port capability__sys_admin ;
  port capability__sys_boot ;
  port capability__sys_chroot ;
  port capability__sys_module ;
  port capability__sys_nice ;
  port capability__sys_pacct ;
  port capability__sys_ptrace ;
  port capability__sys_rawio ;
  port capability__sys_resource ;
  port capability__sys_time ;
  port capability__sys_tty_config ;
  port capability2__mac_admin ;
  port capability2__mac_override ;
  port chr_file__append ;
  port chr_file__create ;
  port chr_file__entrypoint ;
  port chr_file__execmod ;
  port chr_file__execute ;
  port chr_file__execute_no_trans ;
  port chr_file__getattr ;
  port chr_file__ioctl ;
  port chr_file__link ;
  port chr_file__lock ;
  port chr_file__mounton ;
  port chr_file__open ;
  port chr_file__quotaon ;
  port chr_file__read ;
  port chr_file__relabelfrom ;
  port chr_file__relabelto ;
  port chr_file__rename ;
  port chr_file__setattr ;
  port chr_file__swapon ;
  port chr_file__unlink ;
  port chr_file__write ;
  port context__contains ;
  port context__translate ;
  port db_blob__create ;
  port db_blob__drop ;
  port db_blob__export ;
  port db_blob__getattr ;
  port db_blob__import ;
  port db_blob__read ;
  port db_blob__relabelfrom ;
  port db_blob__relabelto ;
  port db_blob__setattr ;
  port db_blob__write ;
  port db_column__create ;
  port db_column__drop ;
  port db_column__getattr ;
  port db_column__insert ;
  port db_column__relabelfrom ;
  port db_column__relabelto ;
  port db_column__select ;
  port db_column__setattr ;
  port db_column__update ;
  port db_column__use ;
  port db_database__access ;
  port db_database__create ;
  port db_database__drop ;
  port db_database__get_param ;
  port db_database__getattr ;
  port db_database__install_module ;
  port db_database__load_module ;
  port db_database__relabelfrom ;
  port db_database__relabelto ;
  port db_database__set_param ;
  port db_database__setattr ;
  port db_procedure__create ;
  port db_procedure__drop ;
  port db_procedure__entrypoint ;
  port db_procedure__execute ;
  port db_procedure__getattr ;
  port db_procedure__relabelfrom ;
  port db_procedure__relabelto ;
  port db_procedure__setattr ;
  port db_table__create ;
  port db_table__delete ;
  port db_table__drop ;
  port db_table__getattr ;
  port db_table__insert ;
  port db_table__lock ;
  port db_table__relabelfrom ;
  port db_table__relabelto ;
  port db_table__select ;
  port db_table__setattr ;
  port db_table__update ;
  port db_table__use ;
  port db_tuple__delete ;
  port db_tuple__insert ;
  port db_tuple__relabelfrom ;
  port db_tuple__relabelto ;
  port db_tuple__select ;
  port db_tuple__update ;
  port db_tuple__use ;
  port dbus__acquire_svc ;
  port dbus__send_msg ;
  port dccp_socket__accept ;
  port dccp_socket__append ;
  port dccp_socket__bind ;
  port dccp_socket__connect ;
  port dccp_socket__create ;
  port dccp_socket__getattr ;
  port dccp_socket__getopt ;
  port dccp_socket__ioctl ;
  port dccp_socket__listen ;
  port dccp_socket__lock ;
  port dccp_socket__name_bind ;
  port dccp_socket__name_connect ;
  port dccp_socket__node_bind ;
  port dccp_socket__read ;
  port dccp_socket__recv_msg ;
  port dccp_socket__recvfrom ;
  port dccp_socket__relabelfrom ;
  port dccp_socket__relabelto ;
  port dccp_socket__send_msg ;
  port dccp_socket__sendto ;
  port dccp_socket__setattr ;
  port dccp_socket__setopt ;
  port dccp_socket__shutdown ;
  port dccp_socket__write ;
  port dir__add_name ;
  port dir__append ;
  port dir__create ;
  port dir__execute ;
  port dir__getattr ;
  port dir__ioctl ;
  port dir__link ;
  port dir__lock ;
  port dir__mounton ;
  port dir__open ;
  port dir__quotaon ;
  port dir__read ;
  port dir__relabelfrom ;
  port dir__relabelto ;
  port dir__remove_name ;
  port dir__rename ;
  port dir__reparent ;
  port dir__rmdir ;
  port dir__search ;
  port dir__setattr ;
  port dir__swapon ;
  port dir__unlink ;
  port dir__write ;
  port fd__use ;
  port fifo_file__append ;
  port fifo_file__create ;
  port fifo_file__execute ;
  port fifo_file__getattr ;
  port fifo_file__ioctl ;
  port fifo_file__link ;
  port fifo_file__lock ;
  port fifo_file__mounton ;
  port fifo_file__open ;
  port fifo_file__quotaon ;
  port fifo_file__read ;
  port fifo_file__relabelfrom ;
  port fifo_file__relabelto ;
  port fifo_file__rename ;
  port fifo_file__setattr ;
  port fifo_file__swapon ;
  port fifo_file__unlink ;
  port fifo_file__write ;
  port file__append ;
  port file__create ;
  port file__entrypoint ;
  port file__execmod ;
  port file__execute ;
  port file__execute_no_trans ;
  port file__getattr ;
  port file__ioctl ;
  port file__link ;
  port file__lock ;
  port file__mounton ;
  port file__open ;
  port file__quotaon ;
  port file__read ;
  port file__relabelfrom ;
  port file__relabelto ;
  port file__rename ;
  port file__setattr ;
  port file__swapon ;
  port file__unlink ;
  port file__write ;
  port filesystem__associate ;
  port filesystem__getattr ;
  port filesystem__mount ;
  port filesystem__quotaget ;
  port filesystem__quotamod ;
  port filesystem__relabelfrom ;
  port filesystem__relabelto ;
  port filesystem__remount ;
  port filesystem__transition ;
  port filesystem__unmount ;
  port ipc__associate ;
  port ipc__create ;
  port ipc__destroy ;
  port ipc__getattr ;
  port ipc__read ;
  port ipc__setattr ;
  port ipc__unix_read ;
  port ipc__unix_write ;
  port ipc__write ;
  port key__create ;
  port key__link ;
  port key__read ;
  port key__search ;
  port key__setattr ;
  port key__view ;
  port key__write ;
  port key_socket__accept ;
  port key_socket__append ;
  port key_socket__bind ;
  port key_socket__connect ;
  port key_socket__create ;
  port key_socket__getattr ;
  port key_socket__getopt ;
  port key_socket__ioctl ;
  port key_socket__listen ;
  port key_socket__lock ;
  port key_socket__name_bind ;
  port key_socket__read ;
  port key_socket__recv_msg ;
  port key_socket__recvfrom ;
  port key_socket__relabelfrom ;
  port key_socket__relabelto ;
  port key_socket__send_msg ;
  port key_socket__sendto ;
  port key_socket__setattr ;
  port key_socket__setopt ;
  port key_socket__shutdown ;
  port key_socket__write ;
  port lnk_file__append ;
  port lnk_file__create ;
  port lnk_file__execute ;
  port lnk_file__getattr ;
  port lnk_file__ioctl ;
  port lnk_file__link ;
  port lnk_file__lock ;
  port lnk_file__mounton ;
  port lnk_file__quotaon ;
  port lnk_file__read ;
  port lnk_file__relabelfrom ;
  port lnk_file__relabelto ;
  port lnk_file__rename ;
  port lnk_file__setattr ;
  port lnk_file__swapon ;
  port lnk_file__unlink ;
  port lnk_file__write ;
  port memprotect__mmap_zero ;
  port msg__receive ;
  port msg__send ;
  port msgq__associate ;
  port msgq__create ;
  port msgq__destroy ;
  port msgq__enqueue ;
  port msgq__getattr ;
  port msgq__read ;
  port msgq__setattr ;
  port msgq__unix_read ;
  port msgq__unix_write ;
  port msgq__write ;
  port netif__dccp_recv ;
  port netif__dccp_send ;
  port netif__egress ;
  port netif__ingress ;
  port netif__rawip_recv ;
  port netif__rawip_send ;
  port netif__tcp_recv ;
  port netif__tcp_send ;
  port netif__udp_recv ;
  port netif__udp_send ;
  port netlink_audit_socket__accept ;
  port netlink_audit_socket__append ;
  port netlink_audit_socket__bind ;
  port netlink_audit_socket__connect ;
  port netlink_audit_socket__create ;
  port netlink_audit_socket__getattr ;
  port netlink_audit_socket__getopt ;
  port netlink_audit_socket__ioctl ;
  port netlink_audit_socket__listen ;
  port netlink_audit_socket__lock ;
  port netlink_audit_socket__name_bind ;
  port netlink_audit_socket__nlmsg_read ;
  port netlink_audit_socket__nlmsg_readpriv ;
  port netlink_audit_socket__nlmsg_relay ;
  port netlink_audit_socket__nlmsg_write ;
  port netlink_audit_socket__read ;
  port netlink_audit_socket__recv_msg ;
  port netlink_audit_socket__recvfrom ;
  port netlink_audit_socket__relabelfrom ;
  port netlink_audit_socket__relabelto ;
  port netlink_audit_socket__send_msg ;
  port netlink_audit_socket__sendto ;
  port netlink_audit_socket__setattr ;
  port netlink_audit_socket__setopt ;
  port netlink_audit_socket__shutdown ;
  port netlink_audit_socket__write ;
  port netlink_dnrt_socket__accept ;
  port netlink_dnrt_socket__append ;
  port netlink_dnrt_socket__bind ;
  port netlink_dnrt_socket__connect ;
  port netlink_dnrt_socket__create ;
  port netlink_dnrt_socket__getattr ;
  port netlink_dnrt_socket__getopt ;
  port netlink_dnrt_socket__ioctl ;
  port netlink_dnrt_socket__listen ;
  port netlink_dnrt_socket__lock ;
  port netlink_dnrt_socket__name_bind ;
  port netlink_dnrt_socket__read ;
  port netlink_dnrt_socket__recv_msg ;
  port netlink_dnrt_socket__recvfrom ;
  port netlink_dnrt_socket__relabelfrom ;
  port netlink_dnrt_socket__relabelto ;
  port netlink_dnrt_socket__send_msg ;
  port netlink_dnrt_socket__sendto ;
  port netlink_dnrt_socket__setattr ;
  port netlink_dnrt_socket__setopt ;
  port netlink_dnrt_socket__shutdown ;
  port netlink_dnrt_socket__write ;
  port netlink_firewall_socket__accept ;
  port netlink_firewall_socket__append ;
  port netlink_firewall_socket__bind ;
  port netlink_firewall_socket__connect ;
  port netlink_firewall_socket__create ;
  port netlink_firewall_socket__getattr ;
  port netlink_firewall_socket__getopt ;
  port netlink_firewall_socket__ioctl ;
  port netlink_firewall_socket__listen ;
  port netlink_firewall_socket__lock ;
  port netlink_firewall_socket__name_bind ;
  port netlink_firewall_socket__nlmsg_read ;
  port netlink_firewall_socket__nlmsg_write ;
  port netlink_firewall_socket__read ;
  port netlink_firewall_socket__recv_msg ;
  port netlink_firewall_socket__recvfrom ;
  port netlink_firewall_socket__relabelfrom ;
  port netlink_firewall_socket__relabelto ;
  port netlink_firewall_socket__send_msg ;
  port netlink_firewall_socket__sendto ;
  port netlink_firewall_socket__setattr ;
  port netlink_firewall_socket__setopt ;
  port netlink_firewall_socket__shutdown ;
  port netlink_firewall_socket__write ;
  port netlink_ip6fw_socket__accept ;
  port netlink_ip6fw_socket__append ;
  port netlink_ip6fw_socket__bind ;
  port netlink_ip6fw_socket__connect ;
  port netlink_ip6fw_socket__create ;
  port netlink_ip6fw_socket__getattr ;
  port netlink_ip6fw_socket__getopt ;
  port netlink_ip6fw_socket__ioctl ;
  port netlink_ip6fw_socket__listen ;
  port netlink_ip6fw_socket__lock ;
  port netlink_ip6fw_socket__name_bind ;
  port netlink_ip6fw_socket__nlmsg_read ;
  port netlink_ip6fw_socket__nlmsg_write ;
  port netlink_ip6fw_socket__read ;
  port netlink_ip6fw_socket__recv_msg ;
  port netlink_ip6fw_socket__recvfrom ;
  port netlink_ip6fw_socket__relabelfrom ;
  port netlink_ip6fw_socket__relabelto ;
  port netlink_ip6fw_socket__send_msg ;
  port netlink_ip6fw_socket__sendto ;
  port netlink_ip6fw_socket__setattr ;
  port netlink_ip6fw_socket__setopt ;
  port netlink_ip6fw_socket__shutdown ;
  port netlink_ip6fw_socket__write ;
  port netlink_kobject_uevent_socket__accept ;
  port netlink_kobject_uevent_socket__append ;
  port netlink_kobject_uevent_socket__bind ;
  port netlink_kobject_uevent_socket__connect ;
  port netlink_kobject_uevent_socket__create ;
  port netlink_kobject_uevent_socket__getattr ;
  port netlink_kobject_uevent_socket__getopt ;
  port netlink_kobject_uevent_socket__ioctl ;
  port netlink_kobject_uevent_socket__listen ;
  port netlink_kobject_uevent_socket__lock ;
  port netlink_kobject_uevent_socket__name_bind ;
  port netlink_kobject_uevent_socket__read ;
  port netlink_kobject_uevent_socket__recv_msg ;
  port netlink_kobject_uevent_socket__recvfrom ;
  port netlink_kobject_uevent_socket__relabelfrom ;
  port netlink_kobject_uevent_socket__relabelto ;
  port netlink_kobject_uevent_socket__send_msg ;
  port netlink_kobject_uevent_socket__sendto ;
  port netlink_kobject_uevent_socket__setattr ;
  port netlink_kobject_uevent_socket__setopt ;
  port netlink_kobject_uevent_socket__shutdown ;
  port netlink_kobject_uevent_socket__write ;
  port netlink_nflog_socket__accept ;
  port netlink_nflog_socket__append ;
  port netlink_nflog_socket__bind ;
  port netlink_nflog_socket__connect ;
  port netlink_nflog_socket__create ;
  port netlink_nflog_socket__getattr ;
  port netlink_nflog_socket__getopt ;
  port netlink_nflog_socket__ioctl ;
  port netlink_nflog_socket__listen ;
  port netlink_nflog_socket__lock ;
  port netlink_nflog_socket__name_bind ;
  port netlink_nflog_socket__read ;
  port netlink_nflog_socket__recv_msg ;
  port netlink_nflog_socket__recvfrom ;
  port netlink_nflog_socket__relabelfrom ;
  port netlink_nflog_socket__relabelto ;
  port netlink_nflog_socket__send_msg ;
  port netlink_nflog_socket__sendto ;
  port netlink_nflog_socket__setattr ;
  port netlink_nflog_socket__setopt ;
  port netlink_nflog_socket__shutdown ;
  port netlink_nflog_socket__write ;
  port netlink_route_socket__accept ;
  port netlink_route_socket__append ;
  port netlink_route_socket__bind ;
  port netlink_route_socket__connect ;
  port netlink_route_socket__create ;
  port netlink_route_socket__getattr ;
  port netlink_route_socket__getopt ;
  port netlink_route_socket__ioctl ;
  port netlink_route_socket__listen ;
  port netlink_route_socket__lock ;
  port netlink_route_socket__name_bind ;
  port netlink_route_socket__nlmsg_read ;
  port netlink_route_socket__nlmsg_write ;
  port netlink_route_socket__read ;
  port netlink_route_socket__recv_msg ;
  port netlink_route_socket__recvfrom ;
  port netlink_route_socket__relabelfrom ;
  port netlink_route_socket__relabelto ;
  port netlink_route_socket__send_msg ;
  port netlink_route_socket__sendto ;
  port netlink_route_socket__setattr ;
  port netlink_route_socket__setopt ;
  port netlink_route_socket__shutdown ;
  port netlink_route_socket__write ;
  port netlink_selinux_socket__accept ;
  port netlink_selinux_socket__append ;
  port netlink_selinux_socket__bind ;
  port netlink_selinux_socket__connect ;
  port netlink_selinux_socket__create ;
  port netlink_selinux_socket__getattr ;
  port netlink_selinux_socket__getopt ;
  port netlink_selinux_socket__ioctl ;
  port netlink_selinux_socket__listen ;
  port netlink_selinux_socket__lock ;
  port netlink_selinux_socket__name_bind ;
  port netlink_selinux_socket__read ;
  port netlink_selinux_socket__recv_msg ;
  port netlink_selinux_socket__recvfrom ;
  port netlink_selinux_socket__relabelfrom ;
  port netlink_selinux_socket__relabelto ;
  port netlink_selinux_socket__send_msg ;
  port netlink_selinux_socket__sendto ;
  port netlink_selinux_socket__setattr ;
  port netlink_selinux_socket__setopt ;
  port netlink_selinux_socket__shutdown ;
  port netlink_selinux_socket__write ;
  port netlink_socket__accept ;
  port netlink_socket__append ;
  port netlink_socket__bind ;
  port netlink_socket__connect ;
  port netlink_socket__create ;
  port netlink_socket__getattr ;
  port netlink_socket__getopt ;
  port netlink_socket__ioctl ;
  port netlink_socket__listen ;
  port netlink_socket__lock ;
  port netlink_socket__name_bind ;
  port netlink_socket__read ;
  port netlink_socket__recv_msg ;
  port netlink_socket__recvfrom ;
  port netlink_socket__relabelfrom ;
  port netlink_socket__relabelto ;
  port netlink_socket__send_msg ;
  port netlink_socket__sendto ;
  port netlink_socket__setattr ;
  port netlink_socket__setopt ;
  port netlink_socket__shutdown ;
  port netlink_socket__write ;
  port netlink_tcpdiag_socket__accept ;
  port netlink_tcpdiag_socket__append ;
  port netlink_tcpdiag_socket__bind ;
  port netlink_tcpdiag_socket__connect ;
  port netlink_tcpdiag_socket__create ;
  port netlink_tcpdiag_socket__getattr ;
  port netlink_tcpdiag_socket__getopt ;
  port netlink_tcpdiag_socket__ioctl ;
  port netlink_tcpdiag_socket__listen ;
  port netlink_tcpdiag_socket__lock ;
  port netlink_tcpdiag_socket__name_bind ;
  port netlink_tcpdiag_socket__nlmsg_read ;
  port netlink_tcpdiag_socket__nlmsg_write ;
  port netlink_tcpdiag_socket__read ;
  port netlink_tcpdiag_socket__recv_msg ;
  port netlink_tcpdiag_socket__recvfrom ;
  port netlink_tcpdiag_socket__relabelfrom ;
  port netlink_tcpdiag_socket__relabelto ;
  port netlink_tcpdiag_socket__send_msg ;
  port netlink_tcpdiag_socket__sendto ;
  port netlink_tcpdiag_socket__setattr ;
  port netlink_tcpdiag_socket__setopt ;
  port netlink_tcpdiag_socket__shutdown ;
  port netlink_tcpdiag_socket__write ;
  port netlink_xfrm_socket__accept ;
  port netlink_xfrm_socket__append ;
  port netlink_xfrm_socket__bind ;
  port netlink_xfrm_socket__connect ;
  port netlink_xfrm_socket__create ;
  port netlink_xfrm_socket__getattr ;
  port netlink_xfrm_socket__getopt ;
  port netlink_xfrm_socket__ioctl ;
  port netlink_xfrm_socket__listen ;
  port netlink_xfrm_socket__lock ;
  port netlink_xfrm_socket__name_bind ;
  port netlink_xfrm_socket__nlmsg_read ;
  port netlink_xfrm_socket__nlmsg_write ;
  port netlink_xfrm_socket__read ;
  port netlink_xfrm_socket__recv_msg ;
  port netlink_xfrm_socket__recvfrom ;
  port netlink_xfrm_socket__relabelfrom ;
  port netlink_xfrm_socket__relabelto ;
  port netlink_xfrm_socket__send_msg ;
  port netlink_xfrm_socket__sendto ;
  port netlink_xfrm_socket__setattr ;
  port netlink_xfrm_socket__setopt ;
  port netlink_xfrm_socket__shutdown ;
  port netlink_xfrm_socket__write ;
  port node__dccp_recv ;
  port node__dccp_send ;
  port node__enforce_dest ;
  port node__rawip_recv ;
  port node__rawip_send ;
  port node__recvfrom ;
  port node__sendto ;
  port node__tcp_recv ;
  port node__tcp_send ;
  port node__udp_recv ;
  port node__udp_send ;
  port nscd__admin ;
  port nscd__getgrp ;
  port nscd__gethost ;
  port nscd__getpwd ;
  port nscd__getserv ;
  port nscd__getstat ;
  port nscd__shmemgrp ;
  port nscd__shmemhost ;
  port nscd__shmempwd ;
  port nscd__shmemserv ;
  port packet__flow_in ;
  port packet__flow_out ;
  port packet__forward_in ;
  port packet__forward_out ;
  port packet__recv ;
  port packet__relabelto ;
  port packet__send ;
  port packet_socket__accept ;
  port packet_socket__append ;
  port packet_socket__bind ;
  port packet_socket__connect ;
  port packet_socket__create ;
  port packet_socket__getattr ;
  port packet_socket__getopt ;
  port packet_socket__ioctl ;
  port packet_socket__listen ;
  port packet_socket__lock ;
  port packet_socket__name_bind ;
  port packet_socket__read ;
  port packet_socket__recv_msg ;
  port packet_socket__recvfrom ;
  port packet_socket__relabelfrom ;
  port packet_socket__relabelto ;
  port packet_socket__send_msg ;
  port packet_socket__sendto ;
  port packet_socket__setattr ;
  port packet_socket__setopt ;
  port packet_socket__shutdown ;
  port packet_socket__write ;
  port passwd__chfn ;
  port passwd__chsh ;
  port passwd__crontab ;
  port passwd__passwd ;
  port passwd__rootok ;
  port peer__recv ;
  port process__dyntransition ;
  port process__execheap ;
  port process__execmem ;
  port process__execstack ;
  port process__fork ;
  port process__getattr ;
  port process__getcap ;
  port process__getpgid ;
  port process__getsched ;
  port process__getsession ;
  port process__noatsecure ;
  port process__ptrace ;
  port process__rlimitinh ;
  port process__setcap ;
  port process__setcurrent ;
  port process__setexec ;
  port process__setfscreate ;
  port process__setkeycreate ;
  port process__setpgid ;
  port process__setrlimit ;
  port process__setsched ;
  port process__setsockcreate ;
  port process__share ;
  port process__sigchld ;
  port process__siginh ;
  port process__sigkill ;
  port process__signal ;
  port process__signull ;
  port process__sigstop ;
  port process__transition ;
  port rawip_socket__accept ;
  port rawip_socket__append ;
  port rawip_socket__bind ;
  port rawip_socket__connect ;
  port rawip_socket__create ;
  port rawip_socket__getattr ;
  port rawip_socket__getopt ;
  port rawip_socket__ioctl ;
  port rawip_socket__listen ;
  port rawip_socket__lock ;
  port rawip_socket__name_bind ;
  port rawip_socket__node_bind ;
  port rawip_socket__read ;
  port rawip_socket__recv_msg ;
  port rawip_socket__recvfrom ;
  port rawip_socket__relabelfrom ;
  port rawip_socket__relabelto ;
  port rawip_socket__send_msg ;
  port rawip_socket__sendto ;
  port rawip_socket__setattr ;
  port rawip_socket__setopt ;
  port rawip_socket__shutdown ;
  port rawip_socket__write ;
  port security__check_context ;
  port security__compute_av ;
  port security__compute_create ;
  port security__compute_member ;
  port security__compute_relabel ;
  port security__compute_user ;
  port security__load_policy ;
  port security__setbool ;
  port security__setcheckreqprot ;
  port security__setenforce ;
  port security__setsecparam ;
  port sem__associate ;
  port sem__create ;
  port sem__destroy ;
  port sem__getattr ;
  port sem__read ;
  port sem__setattr ;
  port sem__unix_read ;
  port sem__unix_write ;
  port sem__write ;
  port shm__associate ;
  port shm__create ;
  port shm__destroy ;
  port shm__getattr ;
  port shm__lock ;
  port shm__read ;
  port shm__setattr ;
  port shm__unix_read ;
  port shm__unix_write ;
  port shm__write ;
  port sock_file__append ;
  port sock_file__create ;
  port sock_file__execute ;
  port sock_file__getattr ;
  port sock_file__ioctl ;
  port sock_file__link ;
  port sock_file__lock ;
  port sock_file__mounton ;
  port sock_file__quotaon ;
  port sock_file__read ;
  port sock_file__relabelfrom ;
  port sock_file__relabelto ;
  port sock_file__rename ;
  port sock_file__setattr ;
  port sock_file__swapon ;
  port sock_file__unlink ;
  port sock_file__write ;
  port socket__accept ;
  port socket__append ;
  port socket__bind ;
  port socket__connect ;
  port socket__create ;
  port socket__getattr ;
  port socket__getopt ;
  port socket__ioctl ;
  port socket__listen ;
  port socket__lock ;
  port socket__name_bind ;
  port socket__read ;
  port socket__recv_msg ;
  port socket__recvfrom ;
  port socket__relabelfrom ;
  port socket__relabelto ;
  port socket__send_msg ;
  port socket__sendto ;
  port socket__setattr ;
  port socket__setopt ;
  port socket__shutdown ;
  port socket__write ;
  port system__ipc_info ;
  port system__syslog_console ;
  port system__syslog_mod ;
  port system__syslog_read ;
  port tcp_socket__accept ;
  port tcp_socket__acceptfrom ;
  port tcp_socket__append ;
  port tcp_socket__bind ;
  port tcp_socket__connect ;
  port tcp_socket__connectto ;
  port tcp_socket__create ;
  port tcp_socket__getattr ;
  port tcp_socket__getopt ;
  port tcp_socket__ioctl ;
  port tcp_socket__listen ;
  port tcp_socket__lock ;
  port tcp_socket__name_bind ;
  port tcp_socket__name_connect ;
  port tcp_socket__newconn ;
  port tcp_socket__node_bind ;
  port tcp_socket__read ;
  port tcp_socket__recv_msg ;
  port tcp_socket__recvfrom ;
  port tcp_socket__relabelfrom ;
  port tcp_socket__relabelto ;
  port tcp_socket__send_msg ;
  port tcp_socket__sendto ;
  port tcp_socket__setattr ;
  port tcp_socket__setopt ;
  port tcp_socket__shutdown ;
  port tcp_socket__write ;
  port udp_socket__accept ;
  port udp_socket__append ;
  port udp_socket__bind ;
  port udp_socket__connect ;
  port udp_socket__create ;
  port udp_socket__getattr ;
  port udp_socket__getopt ;
  port udp_socket__ioctl ;
  port udp_socket__listen ;
  port udp_socket__lock ;
  port udp_socket__name_bind ;
  port udp_socket__node_bind ;
  port udp_socket__read ;
  port udp_socket__recv_msg ;
  port udp_socket__recvfrom ;
  port udp_socket__relabelfrom ;
  port udp_socket__relabelto ;
  port udp_socket__send_msg ;
  port udp_socket__sendto ;
  port udp_socket__setattr ;
  port udp_socket__setopt ;
  port udp_socket__shutdown ;
  port udp_socket__write ;
  port unix_dgram_socket__accept ;
  port unix_dgram_socket__append ;
  port unix_dgram_socket__bind ;
  port unix_dgram_socket__connect ;
  port unix_dgram_socket__create ;
  port unix_dgram_socket__getattr ;
  port unix_dgram_socket__getopt ;
  port unix_dgram_socket__ioctl ;
  port unix_dgram_socket__listen ;
  port unix_dgram_socket__lock ;
  port unix_dgram_socket__name_bind ;
  port unix_dgram_socket__read ;
  port unix_dgram_socket__recv_msg ;
  port unix_dgram_socket__recvfrom ;
  port unix_dgram_socket__relabelfrom ;
  port unix_dgram_socket__relabelto ;
  port unix_dgram_socket__send_msg ;
  port unix_dgram_socket__sendto ;
  port unix_dgram_socket__setattr ;
  port unix_dgram_socket__setopt ;
  port unix_dgram_socket__shutdown ;
  port unix_dgram_socket__write ;
  port unix_stream_socket__accept ;
  port unix_stream_socket__acceptfrom ;
  port unix_stream_socket__append ;
  port unix_stream_socket__bind ;
  port unix_stream_socket__connect ;
  port unix_stream_socket__connectto ;
  port unix_stream_socket__create ;
  port unix_stream_socket__getattr ;
  port unix_stream_socket__getopt ;
  port unix_stream_socket__ioctl ;
  port unix_stream_socket__listen ;
  port unix_stream_socket__lock ;
  port unix_stream_socket__name_bind ;
  port unix_stream_socket__newconn ;
  port unix_stream_socket__read ;
  port unix_stream_socket__recv_msg ;
  port unix_stream_socket__recvfrom ;
  port unix_stream_socket__relabelfrom ;
  port unix_stream_socket__relabelto ;
  port unix_stream_socket__send_msg ;
  port unix_stream_socket__sendto ;
  port unix_stream_socket__setattr ;
  port unix_stream_socket__setopt ;
  port unix_stream_socket__shutdown ;
  port unix_stream_socket__write ;
  port x_client__destroy ;
  port x_client__getattr ;
  port x_client__manage ;
  port x_client__setattr ;
  port x_colormap__add_color ;
  port x_colormap__create ;
  port x_colormap__destroy ;
  port x_colormap__getattr ;
  port x_colormap__install ;
  port x_colormap__read ;
  port x_colormap__remove_color ;
  port x_colormap__uninstall ;
  port x_colormap__use ;
  port x_colormap__write ;
  port x_cursor__create ;
  port x_cursor__destroy ;
  port x_cursor__getattr ;
  port x_cursor__read ;
  port x_cursor__setattr ;
  port x_cursor__use ;
  port x_cursor__write ;
  port x_device__bell ;
  port x_device__force_cursor ;
  port x_device__freeze ;
  port x_device__getattr ;
  port x_device__getfocus ;
  port x_device__grab ;
  port x_device__manage ;
  port x_device__read ;
  port x_device__setattr ;
  port x_device__setfocus ;
  port x_device__use ;
  port x_device__write ;
  port x_drawable__add_child ;
  port x_drawable__blend ;
  port x_drawable__create ;
  port x_drawable__destroy ;
  port x_drawable__get_property ;
  port x_drawable__getattr ;
  port x_drawable__hide ;
  port x_drawable__list_child ;
  port x_drawable__list_property ;
  port x_drawable__manage ;
  port x_drawable__override ;
  port x_drawable__read ;
  port x_drawable__receive ;
  port x_drawable__remove_child ;
  port x_drawable__send ;
  port x_drawable__set_property ;
  port x_drawable__setattr ;
  port x_drawable__show ;
  port x_drawable__write ;
  port x_event__receive ;
  port x_event__send ;
  port x_extension__query ;
  port x_extension__use ;
  port x_font__add_glyph ;
  port x_font__create ;
  port x_font__destroy ;
  port x_font__getattr ;
  port x_font__remove_glyph ;
  port x_font__use ;
  port x_gc__create ;
  port x_gc__destroy ;
  port x_gc__getattr ;
  port x_gc__setattr ;
  port x_gc__use ;
  port x_property__append ;
  port x_property__create ;
  port x_property__destroy ;
  port x_property__getattr ;
  port x_property__read ;
  port x_property__setattr ;
  port x_property__write ;
  port x_resource__read ;
  port x_resource__write ;
  port x_screen__getattr ;
  port x_screen__hide_cursor ;
  port x_screen__saver_getattr ;
  port x_screen__saver_hide ;
  port x_screen__saver_setattr ;
  port x_screen__saver_show ;
  port x_screen__setattr ;
  port x_screen__show_cursor ;
  port x_selection__getattr ;
  port x_selection__read ;
  port x_selection__setattr ;
  port x_selection__write ;
  port x_server__debug ;
  port x_server__getattr ;
  port x_server__grab ;
  port x_server__manage ;
  port x_server__record ;
  port x_server__setattr ;
  port x_synthetic_event__receive ;
  port x_synthetic_event__send ;
}

// Example using the prelude

domain t = Type("etc_t");
domain a = Process("a");
domain b = Process("b");
t.active -- b.create;
//a.active -- t.file__read;
domain f = File("ff");
t.active -- f.read;
a.active -- t.file__write;
